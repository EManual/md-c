代码如下：
[code=java]
#define ERR 5
#define OK 6
#include <stdio.h>
#[Keywords]int #status;
#[Keywords]double #result,sig,scale;
#[Keywords]int #sign(#[Keywords]int #c)#[Tags]/*处理数的符号函数*/
{
	#[Keywords]if#(c==#[Fields]'-'#)#[Tags]/*若为负号，置负数标记*/
		#sig=-sig;
#}
#[Keywords]int #integer(#[Keywords]int #c)#[Tags]/*转换整数部分，转换一位整数位*/
{
	#result=result*10.0+c-#[Fields]'0'#;
#}
#[Keywords]int #decimal(#[Keywords]int #c)#[Tags]/*转换小数部分，转换一位小数位*/
{
	#result+=(c-#[Fields]'0'#)*scale;
	#scale/=10.0;
#}
#[Tags]/*状态表*/
#[Keywords]int #statbl[ ][4]={{   1,2,3,ERR#},#[Tags]/*0*/
	        #{ERR,2,3,ERR#},#[Tags]/*1*/
	        #{OK,2,4,OK#},#[Tags]/*2*/
	        #{ERR,4,ERR,ERR#},#[Tags]/*3*/
	        #{OK,4,OK,OK#}#};#[Tags]/*4*/
#[Tags]/*转换函数表*/
int(*funtbl[ ][4])( )={{sign,integer,NULL,NULL#},
	                #{NULL,integer,NULL,NULL#},
	                #{NULL,integer,NULL,NULL#},
	                #{NULL,decimal,NULL,NULL#},
                                    #{NULL,decimal,NULL,NULL#}#};
#[Keywords]int #readreal(#[Keywords]double #*dp)
{
	#[Keywords]int #c,ckind;
	#sig=1.0;
	#result=0.0;
	#scale=0.1;
	#[Keywords]while#((c=getchar( ))==#[Fields]' '#||c==#[Fields]'\n'#||c==#[Fields]'\t'#);#[Tags]/*跳过前导空白符*/
	#status=0;#[Tags]/*置初始状态*/
	#[Keywords]for#(;;)
	#{
		#/*分类当前字符*/
		#[Keywords]if#(c==#[Fields]'+'#||c==#[Fields]'-'#) ckind=0;#[Tags]/*数的符号字符*/
		#[Keywords]else #[Keywords]if#(c>=#[Fields]'0'#&&c<=#[Fields]'9'#) ckind=1;#[Tags]/*数字符*/
		#[Keywords]else #[Keywords]if#(c==#[Fields]'.'#) ckind=2;#[Tags]/*小数点*/
		#[Keywords]else #ckind=3;#[Tags]/* 其它字符 */

		#[Keywords]if#(funtbl[status][ckind])#[Tags]/* 如有转换函数 */
			#(*funtbl[status][ckind])(c);#[Tags]/* 执行相应的函数 */
		#status=statbl[status][ckind];#[Tags]/*设置新的状态*/
		#[Keywords]if#(status==ERR||status==OK)#[Keywords]break#;#[Tags]/* 结束：出错或成功 */
		#c=getchar();
	#}
	#ungetc(c,stdin); #[Tags]/* 归还数德结束符 */
	#[Keywords]if#(status==OK)
	#{
		#*dp=result *sig;#[Tags]/* 读入数按指针参数赋给相应变量 */
		#[Keywords]return #1;
	#}
	#[Keywords]return #-1; #[Tags]/* 出错返回 */
#}
main()
{
	#[Keywords]double #x;
	#clrscr();
	#printf(#[Fields]"\nPlease input real numbers (use nonreal #[Keywords]char #to end input):\n"#);
	#[Keywords]while#(readreal(&x)==1)
		#printf(#[Fields]"The real number you input is: %f\n"#,x);
	#printf(#[Fields]"\nYou have inputted nonreal char.\n Press any key to quit...\n"#);
	#getch();
#}
[/code]