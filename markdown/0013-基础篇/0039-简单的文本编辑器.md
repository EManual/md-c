代码如下：
[code=java]
#include <stdio.h>
#define MAXLEN 80
#define MAXLINE 200
#[Keywords]char #buffer[MAXLEN],fname[120];
#[Keywords]char #*lineptr[MAXLINE];
FILE *fp;
#[Keywords]void #edit(),replace(),insert(),delete(),quit();
#[Keywords]char #comch[]=#[Fields]"EeRrIiDdQq"#;#[Tags]/*命令符*/
void(*comfun[])()={edit,replace,insert,delete,quit#};#[Tags]/*对应处理函数*/
#[Keywords]int #modified=0,#[Tags]/*正文被修改标志*/
	#last;#[Tags]/*当前正文行数*/
#[Keywords]char #*chpt;#[Tags]/*输入命令行字符指针*/
main()
{
	#[Keywords]int #j;
	#last=0;
	#[Keywords]while#(1)
	#{
		#printf(#[Fields]"\nInput a command:[e,r,i,d,q].\n"#);
		#gets(buffer);#[Tags]/*读入命令行*/
		#[Keywords]for#(chpt=buffer;*chpt==#[Fields]''#||*chpt==#[Fields]'\t'#;chpt++);#[Tags]/*掠过空白符*/
		#[Keywords]if#(*chpt==#[Fields]'\0'#) #[Keywords]continue#;#[Tags]/*空行重新输入*/
		#[Keywords]for#(j=0;comch[j]!=#[Fields]'\0'#&&comch[j]!=*chpt;j++);#[Tags]/*查命令符*/
		#[Keywords]if#(comch[j]==#[Fields]'\0'#) #[Keywords]continue#;#[Tags]/*非法命令符*/
		#chpt++;#[Tags]/*掠过命令符，指向参数*/
		#(*comfun[j/2])();#[Tags]/*执行对应函数*/
		#fprintf(stdout,#[Fields]"The text is:\n"#);
		#[Keywords]for#(j=0;j<last;j++)#[Tags]/*显示正文*/
			#fputs(lineptr[j],stdout);
	#}
#}
#[Keywords]void #quit()
{
	#[Keywords]int #c;
	#[Keywords]if#(modified)#[Tags]/* 如正文被修改 */
	#{
		#printf(#[Fields]"Save? (y/n)"#);
		#[Keywords]while#(!(((c=getchar())>=#[Fields]'a'#&&c<=#[Fields]'z'#)||(c>=#[Fields]'A'#&&c<=#[Fields]'Z'#)));
		#[Keywords]if#(c==#[Fields]'y'#||c==#[Fields]'Y'#)
			#save(fname); #[Tags]/* 保存被修改过的正文 */
	#}
	#[Keywords]for#(c=0;c<last;c++)
		#free(lineptr[c]);	#[Tags]/* 释放内存 */
	#exit(0);
#}

#[Keywords]void #insert()
{
	#[Keywords]int #k,m,i;
	#sscanf(chpt,#[Fields]"%d%d"#,&k,&m);	#[Tags]/* 读入参数 */
	#[Keywords]if#(m<0||m>last||last+k>=MAXLINE)#[Tags]/* 检查参数合理性 */
	#{
		#printf(#[Fields]"Error!\n"#);
		#[Keywords]return#;#
	#}
	#[Keywords]for#(i=last;i>m;i--)#[Tags]/* 后继行向后移 */
		#lineptr[i+k-1]=lineptr[i-1];
	#[Keywords]for#(i=0;i<k;i++)   #[Tags]/* 读入k行正文，并插入 */
	#{
		#fgets(buffer,MAXLEN,stdin);
		#lineptr[m+i]=(#[Keywords]char #*)malloc(strlen(buffer)+1);
		#strcpy(lineptr[m+i],buffer);
	#}
	#last+=k;	#[Tags]/* 修正正文行数 */
	#modified=1;	#[Tags]/* 正文被修改 */
#}
#[Keywords]void #delete()
{
	#[Keywords]int #i,j,m,n;
	#sscanf(chpt,#[Fields]"%d%d"#,&m,&n);	#[Tags]/* 读入参数 */
	#[Keywords]if#(m<=0||m>last||n<m)	#[Tags]/* 检查参数合理性 */
	#{
		#printf(#[Fields]"Error!\n"#);
		#[Keywords]return#;#
	#}
	#[Keywords]if#(n>last)
		#n=last;		#[Tags]/* 修正参数 */
	#[Keywords]for#(i=m;i<=n;i++)	#[Tags]/* 删除正文 */
		#free(lineptr[i-1]);
	#[Keywords]for#(i=m,j=n+1;j<=last;i++,j++)
		#lineptr[i-1]=lineptr[j-1];
	#last=i-1;	#[Tags]/* 修正正文行数 */
	#modified=1;	#[Tags]/* 正文被修改 */
#}
#[Keywords]void #replace()
{
	#[Keywords]int #k,m,n,i,j;
	#sscanf(chpt,#[Fields]"%d%d%d"#,&k,&m,&n);	#[Tags]/* 读入参数 */
	#[Keywords]if#(m<=0||m>last||n<m||last-(n-m+1)+k>=MAXLINE)#[Tags]/* 检查参数合理性 */
	#{
		#printf(#[Fields]"Error!\n"#);
		#[Keywords]return#;#
	#}
	#/* 先完成删除 */
	#[Keywords]if#(n>last)
		#n=last;		#[Tags]/* 修正参数 */
	#[Keywords]for#(i=m;i<=n;i++)	#[Tags]/* 删除正文 */
		#free(lineptr[i-1]);
	#[Keywords]for#(i=m,j=n+1;j<=last;i++,j++)
		#lineptr[i-1]=lineptr[j-1];
	#last=i-1;
	#/* 以下完成插入 */
	#[Keywords]for#(i=last;i>=m;i--)
		#lineptr[i+k-1]=lineptr[i-1];
	#[Keywords]for#(i=0;i<k;i++)
	#{
		#fgets(buffer,MAXLEN,stdin);
		#lineptr[m+i-1]=(#[Keywords]char #*)malloc(strlen(buffer)+1);
		#strcpy(lineptr[m+i-1],buffer);
	#}
	#last+=k;	#[Tags]/* 修正正文行数 */
	#modified=1;	#[Tags]/* 正文被修改 */
#}
save(#[Keywords]char #*fname)	#[Tags]/* 保存文件 */
{
	#[Keywords]int #i;
	#FILE *fp;
	#[Keywords]if#((fp=fopen(fname,#[Fields]"w"#))==NULL)
	#{
		#fprintf(stderr,#[Fields]"Can#[Fields]'t open %s.\n"#,fname);
		#exit(1);
	#}
	#[Keywords]for#(i=0;i<last;i++)
	#{
		#fputs(lineptr[i],fp);
		#free(lineptr[i]);
	#}
	#fclose(fp);
#}
#[Keywords]void #edit()	#[Tags]/* 编辑命令 */
{
	#[Keywords]int #i;
	#FILE *fp;
	#i=sscanf(chpt,#[Fields]"%s"#,fname);	#[Tags]/* 读入文件名 */
	#[Keywords]if#(i!=1)
	#{
		#printf(#[Fields]"Enter file name.\n"#);
		#scanf(#[Fields]"%s"#,fname);
	#}
	#[Keywords]if#((fp=fopen(fname,#[Fields]"r"#))==NULL) #[Tags]/* 读打开 */
	#{
		#fp=fopen(fname,#[Fields]"w"#);	#[Tags]/* 如不存在，则创建文件 */
		#fclose(fp);
		#fp=fopen(fname,#[Fields]"r"#);	#[Tags]/* 重新读打开 */
	#}
	#i=0;
	#[Keywords]while#(fgets(buffer,MAXLEN,fp)==buffer)
	#{
		#lineptr[i]=(#[Keywords]char #*)malloc(strlen(buffer)+1);
		#strcpy(lineptr[i++],buffer);
	#}
	#fclose(fp);
	#last=i;
#}
[/code]